<div id="pf10f" class="pf w0 h0" data-page-no="10f"><div class="pc pc10f w0 h0"><img class="bi x0 ya5 w2 hb" alt="" src="bg10f.png"/><div class="t m0 x9 hc ya6 ff1 fs6 fc0 sc0 ls0 ws0">Chapter 17</div><div class="t m0 x9 hc ya7 ff1 fs6 fc0 sc0 ls0 ws0">Bit Manipulation Engine (BME)</div><div class="t m0 x9 hd ya8 ff1 fs7 fc0 sc0 ls0 ws22c">17.1 Introduction</div><div class="t m0 x9 hf yde ff3 fs5 fc0 sc0 ls0 ws0">The Bit Manipulation Engine (BME) provides hardware support for atomic read-modify-</div><div class="t m0 x9 hf ydf ff3 fs5 fc0 sc0 ls0 ws0">write memory operations to the peripheral address space in Cortex-M0+ based</div><div class="t m0 x9 hf ye0 ff3 fs5 fc0 sc0 ls0 ws0">microcontrollers. This architectural capability is also known as &quot;decorated storage&quot; as it</div><div class="t m0 x9 hf y1817 ff3 fs5 fc0 sc0 ls0 ws0">defines a mechanism for providing additional semantics for load and store operations to</div><div class="t m0 x9 hf y1818 ff3 fs5 fc0 sc0 ls0 ws0">memory-mapped peripherals beyond just the reading and writing of data values to the</div><div class="t m0 x9 hf y1819 ff3 fs5 fc0 sc0 ls0 ws0">addressed memory locations. In the BME definition, the &quot;decoration&quot;, that is, the</div><div class="t m0 x9 hf y181a ff3 fs5 fc0 sc0 ls0 ws0">additional semantic information, is encoded into the peripheral address used to reference</div><div class="t m0 x9 hf y181b ff3 fs5 fc0 sc0 ls0 ws0">the memory.</div><div class="t m0 x9 hf y181c ff3 fs5 fc0 sc0 ls0 ws0">By combining the basic load and store instructions of the Cortex-M instruction set</div><div class="t m0 x9 hf y181d ff3 fs5 fc0 sc0 ls0 ws0">architecture (v6M, v7M) with the concept of decorated storage provided by the BME, the</div><div class="t m0 x9 hf y181e ff3 fs5 fc0 sc0 ls0 ws0">resulting implementation provides a robust and efficient read-modify-write capability to</div><div class="t m0 x9 hf y181f ff3 fs5 fc0 sc0 ls0 ws0">this class of ultra low-end microcontrollers. The resulting architectural capability defined</div><div class="t m0 x9 hf y1820 ff3 fs5 fc0 sc0 ls0 ws0">by this core platform function is targeted at the manipulation of n-bit fields in peripheral</div><div class="t m0 x9 hf y1821 ff3 fs5 fc0 sc0 ls0 ws0">registers and is consistent with I/O hardware addressing in the Embedded C standard. For</div><div class="t m0 x9 hf y1822 ff3 fs5 fc0 sc0 ls0 ws0">most BME commands, a single core read or write bus cycle is converted into an atomic</div><div class="t m0 x9 hf y1823 ff3 fs5 fc0 sc0 ls0 ws0">read-modify-write, that is, an indivisible &quot;read followed by a write&quot; bus sequence.</div><div class="t m0 x9 hf y1824 ff3 fs5 fc0 sc0 ls0 ws0">BME decorated references are only available on system bus transactions generated by the</div><div class="t m0 x9 hf y1825 ff3 fs5 fc0 sc0 ls0 ws0">processor core and targeted at the standard 512 KB peripheral address space based at</div><div class="t m0 x9 h15 y1826 ff3 fs5 fc0 sc0 ls0 ws1a6">0x4000_0000<span class="fs8 fc1 ws198 v3">1</span><span class="ws0">. The decoration semantic is embedded into address bits[28:19], creating a</span></div><div class="t m0 x9 hf y1827 ff3 fs5 fc0 sc0 ls0 ws0">448 MB space at addresses 0x4400_0000 - 0x5FFF_FFFF; these bits are stripped out of</div><div class="t m0 x9 hf y1828 ff3 fs5 fc0 sc0 ls0 ws0">the actual address sent to the peripheral bus controller and used by the BME to define and</div><div class="t m0 x9 hf y1829 ff3 fs5 fc0 sc0 ls0 ws0">control its operation.</div><div class="t m0 x2c h7 y182a ff2 fs4 fc0 sc0 ls0 ws0">1.<span class="_ _1a"> </span>To be perfectly accurate, the peripheral address space occupies a 516 KB region: 512 KB based at 0x4000_0000 plus a 4</div><div class="t m0 x91 h7 y182b ff2 fs4 fc0 sc0 ls0 ws0">KB space based at 0x400F_F000 for GPIO accesses. This organization provides compatibility with the Kinetis K Family.</div><div class="t m0 x91 h7 y182c ff2 fs4 fc0 sc0 ls0 ws0">Attempted accesses to the memory space located between 0x4008_0000 - 0x400E_FFFF are error terminated due to an</div><div class="t m0 x91 h7 y182d ff2 fs4 fc0 sc0 ls0 ws0">illegal address.</div><div class="t m0 x8 h6 ybc ff1 fs3 fc0 sc0 ls0 ws0">KL25 Sub-Family Reference Manual, Rev. 3, September 2012</div><div class="t m0 x9 h7 ybd ff2 fs4 fc0 sc0 ls0 ws0">Freescale Semiconductor, Inc.<span class="_ _113"> </span>271</div><a class="l" href="#pf10f" data-dest-detail='[271,"XYZ",null,116,null]'><div class="d m1" style="border-style:none;position:absolute;left:131.000000px;bottom:216.054000px;width:5.250000px;height:10.500000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div></div>
