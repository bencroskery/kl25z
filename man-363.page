<div id="pf16b" class="pf w0 h0" data-page-no="16b"><div class="pc pc16b w0 h0"><img class="bi x0 y8 w2 h5" alt="" src="bg16b.png"/><div class="t m0 x2 hf yf6 ff3 fs5 fc0 sc0 ls0 ws199">• SAR<span class="ff4 ws1a6">n</span><span class="ws0"> and DAR<span class="ff4 ws1a6">n</span> change after each data transfer depending on DCR<span class="ff4 ws1a6">n</span>[SSIZE,</span></div><div class="t m0 x3d hf yf7 ff3 fs5 fc0 sc0 ls0 ws0">DSIZE, SINC, DINC, SMOD, DMOD] and the starting addresses. Increment</div><div class="t m0 x3d hf yf8 ff3 fs5 fc0 sc0 ls0 ws0">values can be 1, 2, or 4 for 8-bit, 16-bit, or 32-bit transfers, respectively. If the</div><div class="t m0 x3d hf yf9 ff3 fs5 fc0 sc0 ls0 ws0">address register is programmed to remain unchanged, the register is not</div><div class="t m0 x3d hf yfa ff3 fs5 fc0 sc0 ls0 ws0">incremented after the data transfer.</div><div class="t m0 x2 hf y62a ff3 fs5 fc0 sc0 ls0 ws199">• BCR<span class="ff4 ws1a6">n</span><span class="ws0">[BCR] must be loaded with the total number of bytes to be transferred. It</span></div><div class="t m0 x3d hf yabd ff3 fs5 fc0 sc0 ls0 ws0">is decremented by 1, 2, or 4 at the end of each transfer, depending on the transfer</div><div class="t m0 x3d hf y644 ff3 fs5 fc0 sc0 ls0 ws0">size. DSR<span class="ff4 ws1a6">n</span>[DONE] must be cleared for channel startup.</div><div class="t m0 x33 hf yad5 ff3 fs5 fc0 sc0 ls0 ws0">•<span class="_ _11"> </span>After the channel has been initialized, it may be started by setting DCR<span class="ff4 ws1a6">n</span>[START] or</div><div class="t m0 x117 hf yad6 ff3 fs5 fc0 sc0 ls0 ws0">a properly selected peripheral DMA request, depending on the status of</div><div class="t m0 x117 hf yad7 ff3 fs5 fc0 sc0 ls0 ws1a6">DCR<span class="ff4">n</span><span class="ws0">[ERQ]. For a software-initiated transfer, the channel can be started by setting</span></div><div class="t m0 x117 hf y2040 ff3 fs5 fc0 sc0 ls0 ws1a6">DCR<span class="ff4">n</span><span class="ws0">[START] as part of a single 32-bit write to the last 32 bits of the TCD</span><span class="ff4">n</span><span class="ws0">; that is,</span></div><div class="t m0 x117 hf y2041 ff3 fs5 fc0 sc0 ls0 ws0">it is not required to write the DCR<span class="ff4 ws1a6">n</span> with START cleared and then perform a second</div><div class="t m0 x117 hf yaf1 ff3 fs5 fc0 sc0 ls0 ws0">write to explicitly set START.</div><div class="t m0 x33 hf yadb ff3 fs5 fc0 sc0 ls0 ws0">•<span class="_ _11"> </span>Programming the channel for a software-initiated request causes the channel to</div><div class="t m0 x117 hf yadc ff3 fs5 fc0 sc0 ls0 ws0">request the system bus and start transferring data immediately. If the channel is</div><div class="t m0 x117 hf y2042 ff3 fs5 fc0 sc0 ls0 ws0">programmed for peripheral-initiated request, a properly selected peripheral DMA</div><div class="t m0 x117 hf y2043 ff3 fs5 fc0 sc0 ls0 ws0">request must be asserted before the channel begins the system bus transfers.</div><div class="t m0 x33 hf y2044 ff3 fs5 fc0 sc0 ls0 ws0">•<span class="_ _11"> </span>The hardware can automatically clear DCR<span class="ff4 ws1a6">n</span>[ERQ], disabling the peripheral request,</div><div class="t m0 x117 hf y2045 ff3 fs5 fc0 sc0 ls0 ws0">when BCR<span class="ff4 ws1a6">n</span> reaches zero by setting DCR<span class="ff4 ws1a6">n</span>[D_REQ].</div><div class="t m0 x33 hf y2046 ff3 fs5 fc0 sc0 ls0 ws0">•<span class="_ _11"> </span>Changes to DCR<span class="ff4 ws1a6">n</span> are effective immediately while the channel is active. To avoid</div><div class="t m0 x117 hf y2047 ff3 fs5 fc0 sc0 ls0 ws0">problems with changing a DMA channel setup, write a one to DSR<span class="ff4 ws1a6">n</span>[DONE] to stop</div><div class="t m0 x117 hf y2048 ff3 fs5 fc0 sc0 ls0 ws0">the DMA channel.</div><div class="t m0 x9 he y2049 ff1 fs1 fc0 sc0 ls0 ws0">23.4.3<span class="_ _b"> </span>Dual-Address Data Transfer Mode</div><div class="t m0 x9 hf y204a ff3 fs5 fc0 sc0 ls0 ws0">Each channel supports dual-address transfers. Dual-address transfers consist of a source</div><div class="t m0 x9 hf y204b ff3 fs5 fc0 sc0 ls0 ws0">data read and a destination data write. The DMA controller module begins a dual-address</div><div class="t m0 x9 hf y204c ff3 fs5 fc0 sc0 ls0 ws0">transfer sequence after a DMA request. If no error condition exists, DSR<span class="ff4 ws1a6">n</span>[REQ] is set.</div><div class="t m0 x33 hf y204d ff3 fs5 fc0 sc0 ls0 ws0">•<span class="_ _11"> </span>Dual-address read—The DMA controller drives the SAR<span class="ff4 ws1a6">n</span> value onto the system</div><div class="t m0 x117 hf y204e ff3 fs5 fc0 sc0 ls0 ws0">address bus. If DCR<span class="ff4 ws1a6">n</span>[SINC] is set, the SAR<span class="ff4 ws1a6">n</span> increments by the appropriate number</div><div class="t m0 x117 hf y204f ff3 fs5 fc0 sc0 ls0 ws0">of bytes upon a successful read cycle. When the appropriate number of read cycles</div><div class="t m0 x117 hf y2050 ff3 fs5 fc0 sc0 ls0 ws0">complete (multiple reads if the destination size is larger than the source), the DMA</div><div class="t m0 x117 hf y2051 ff3 fs5 fc0 sc0 ls0 ws0">initiates the write portion of the transfer.</div><div class="t m0 x9 hf y2052 ff3 fs5 fc0 sc0 ls0 ws0">If a termination error occurs, DSR<span class="ff4 ws1a6">n</span>[BES, DONE] are set and DMA transactions stop.</div><div class="t m0 x4e h10 y141 ff1 fs4 fc0 sc0 ls0 ws0">Chapter 23 DMA Controller Module</div><div class="t m0 x8 h6 y9 ff1 fs3 fc0 sc0 ls0 ws0">KL25 Sub-Family Reference Manual, Rev. 3, September 2012</div><div class="t m0 x9 h7 ya ff2 fs4 fc0 sc0 ls0 ws0">Freescale Semiconductor, Inc.<span class="_ _113"> </span>363</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div></div>
