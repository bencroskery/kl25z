<div id="pf186" class="pf w0 h0" data-page-no="186"><div class="pc pc186 w0 h0"><img class="bi x0 y8 w2 h5" alt="" src="bg186.png"/><div class="t m0 x9 he ybe ff1 fs1 fc0 sc0 ls0 ws0">24.4.6<span class="_ _b"> </span>MCG PLL clock</div><div class="t m0 x9 hf ybf ff3 fs5 fc0 sc0 ls0 ws0">The MCG PLL Clock (MCGPLLCLK) is available depending on the device&apos;s</div><div class="t m0 x9 hf y282 ff3 fs5 fc0 sc0 ls0 ws0">configuration of the MCG module. For more details, see the clock distribution chapter of</div><div class="t m0 x9 hf y283 ff3 fs5 fc0 sc0 ls0 ws0">this MCU. The MCGPLLCLK is prevented from coming out of the MCG until it is</div><div class="t m0 x9 hf y2d8 ff3 fs5 fc0 sc0 ls0 ws0">enabled and S[LOCK0] is set.</div><div class="t m0 x9 he y22e5 ff1 fs1 fc0 sc0 ls0 ws0">24.4.7<span class="_ _b"> </span>MCG Auto TRIM (ATM)</div><div class="t m0 x9 hf y2da ff3 fs5 fc0 sc0 ls0 ws0">The MCG Auto Trim (ATM) is a MCG feature that when enabled, it configures the MCG</div><div class="t m0 x9 hf yde ff3 fs5 fc0 sc0 ls0 ws0">hardware to automatically trim the MCG Internal Reference Clocks using an external</div><div class="t m0 x9 hf ydf ff3 fs5 fc0 sc0 ls0 ws0">clock as a reference. The selection between which MCG IRC clock gets tested and</div><div class="t m0 x9 hf ye0 ff3 fs5 fc0 sc0 ls0 ws0">enabled is controlled by the ATC[ATMS] control bit (ATC[ATMS]=0 selects the 32 kHz</div><div class="t m0 x9 hf y1817 ff3 fs5 fc0 sc0 ls0 ws0">IRC and ATC[ATMS]=1 selects the 4 MHz IRC). If 4 MHz IRC is selected for the ATM,</div><div class="t m0 x9 hf y22e6 ff3 fs5 fc0 sc0 ls0 ws0">a divide by 128 is enabled to divide down the 4 MHz IRC to a range of 31.250 kHz.</div><div class="t m0 x9 hf y22e7 ff3 fs5 fc0 sc0 ls0 ws0">When MCG ATM is enabled by writing ATC[ATME] bit to 1, The ATM machine will</div><div class="t m0 x9 hf y22e8 ff3 fs5 fc0 sc0 ls0 ws0">start auto trimming the selected IRC clock. During the autotrim process, ATC[ATME]</div><div class="t m0 x9 hf y22e9 ff3 fs5 fc0 sc0 ls0 ws0">will remain asserted and will deassert after ATM is completed or an abort occurs. The</div><div class="t m0 x9 hf y181c ff3 fs5 fc0 sc0 ls0 ws0">MCG ATM is aborted if a write to any of the following control registers is detected : C1,</div><div class="t m0 x9 hf y181d ff3 fs5 fc0 sc0 ls0 ws0">C3, C4, or ATC or if Stop mode is entered. If an abort occurs, ATC[ATMF] fail flag is</div><div class="t m0 x9 hf y181e ff3 fs5 fc0 sc0 ls0">asserted.</div><div class="t m0 x9 hf y22ea ff3 fs5 fc0 sc0 ls0 ws0">The ATM machine uses the bus clock as the external reference clock to perform the IRC</div><div class="t m0 x9 hf y22eb ff3 fs5 fc0 sc0 ls0 ws0">auto-trim. Therefore, it is required that the MCG is configured in a clock mode where the</div><div class="t m0 x9 hf y22ec ff3 fs5 fc0 sc0 ls0 ws0">reference clock used to generate the system clock is the external reference clock such as</div><div class="t m0 x9 hf y22ed ff3 fs5 fc0 sc0 ls0 ws0">FBE clock mode. The MCG must not be configured in a clock mode where selected IRC</div><div class="t m0 x9 hf y22ee ff3 fs5 fc0 sc0 ls0 ws0">ATM clock is used to generate the system clock. The bus clock is also required to be</div><div class="t m0 x9 hf y1824 ff3 fs5 fc0 sc0 ls0 ws0">running with in the range of 8â€“16 MHz.</div><div class="t m0 x9 hf y22ef ff3 fs5 fc0 sc0 ls0 ws0">To perform the ATM on the selected IRC, the ATM machine uses the successive</div><div class="t m0 x9 hf y22f0 ff3 fs5 fc0 sc0 ls0 ws0">approximation technique to adjust the IRC trim bits to generate the desired IRC trimmed</div><div class="t m0 x9 hf y22f1 ff3 fs5 fc0 sc0 ls0 ws0">frequency. The ATM SARs each of the ATM IRC trim bits starting with the MSB. For</div><div class="t m0 x9 hf y22f2 ff3 fs5 fc0 sc0 ls0 ws0">each trim bit test, the ATM uses a pulse that is generated by the ATM selected IRC clock</div><div class="t m0 x9 hf y22f3 ff3 fs5 fc0 sc0 ls0 ws0">to enable a counter that counts number of ATM external clocks. At end of each trim bit,</div><div class="t m0 x9 hf y22f4 ff3 fs5 fc0 sc0 ls0 ws0">the ATM external counter value is compared to the ATCV[15:0] register value. Based on</div><div class="t m0 x9 hf y22f5 ff3 fs5 fc0 sc0 ls0 ws0">the comparison result, the ATM trim bit under test will get cleared or stay asserted. This</div><div class="t m0 x9 hf ya71 ff3 fs5 fc0 sc0 ls0 ws0">is done until all trim bits have been tested by ATM SAR machine.</div><div class="t m0 x9 h10 ydd ff1 fs4 fc0 sc0 ls0 ws0">Functional Description</div><div class="t m0 x8 h6 y9 ff1 fs3 fc0 sc0 ls0 ws0">KL25 Sub-Family Reference Manual, Rev. 3, September 2012</div><div class="t m0 x9 h7 ya ff2 fs4 fc0 sc0 ls0 ws0">390<span class="_ _113"> </span>Freescale Semiconductor, Inc.</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div></div>
