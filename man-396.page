<div id="pf18c" class="pf w0 h0" data-page-no="18c"><div class="pc pc18c w0 h0"><img class="bi x0 y8 w2 h5" alt="" src="bg18c.png"/><div class="t m0 x29 hf yf6 ff3 fs5 fc0 sc0 ls0 ws0">•<span class="_ _11"> </span>C1[FRDIV] set to 3&apos;b010, or divide-by-128 because 4 MHz / 128 = 31.25</div><div class="t m0 x3e hf yf7 ff3 fs5 fc0 sc0 ls0 ws0">kHz which is in the 31.25 kHz to 39.0625 kHz range required by the FLL</div><div class="t m0 x29 hf y504 ff3 fs5 fc0 sc0 ls0 ws0">•<span class="_ _11"> </span>C1[IREFS] cleared to 0, selecting the external reference clock and enabling</div><div class="t m0 x3e hf y505 ff3 fs5 fc0 sc0 ls0 ws0">the external oscillator.</div><div class="t m0 x8b hf y672 ff3 fs5 fc0 sc0 ls0 ws0">c.<span class="_ _11"> </span>Loop until S[OSCINIT0] is 1, indicating the crystal selected by C2[EREFS0] has</div><div class="t m0 x3d hf y673 ff3 fs5 fc0 sc0 ls0 ws0">been initialized.</div><div class="t m0 x8b hf y6dd ff3 fs5 fc0 sc0 ls0 ws0">d.<span class="_ _11"> </span>Loop until S[IREFST] is 0, indicating the external reference is the current source</div><div class="t m0 x3d hf y1d5d ff3 fs5 fc0 sc0 ls0 ws0">for the reference clock.</div><div class="t m0 x8b hf y7a0 ff3 fs5 fc0 sc0 ls0 ws0">e.<span class="_ _11"> </span>Loop until S[CLKST] is 2&apos;b10, indicating that the external reference clock is</div><div class="t m0 x3d hf y2363 ff3 fs5 fc0 sc0 ls0 ws0">selected to feed MCGOUTCLK.</div><div class="t m0 xf6 hf y2364 ff3 fs5 fc0 sc0 ls0 ws0">2.<span class="_ _11"> </span>Then configure C5[PRDIV0] to generate correct PLL reference frequency.</div><div class="t m0 x8b hf y2365 ff3 fs5 fc0 sc0 ls0 ws0">a.<span class="_ _11"> </span>C5 = 0x01</div><div class="t m0 x29 hf y2366 ff3 fs5 fc0 sc0 ls0 ws0">•<span class="_ _11"> </span>C5[PRDIV0] set to 5&apos;b001, or divide-by-2 resulting in a pll reference</div><div class="t m0 x3e hf y2367 ff3 fs5 fc0 sc0 ls0 ws0">frequency of 4 MHz/2 = 2 MHz.</div><div class="t m0 xf6 hf y2368 ff3 fs5 fc0 sc0 ls0 ws0">3.<span class="_ _11"> </span>Then, FBE must transition either directly to PBE mode or first through BLPE mode</div><div class="t m0 x117 hf y2369 ff3 fs5 fc0 sc0 ls0 ws0">and then to PBE mode:</div><div class="t m0 x8b hf y236a ff3 fs5 fc0 sc0 ls0 ws0">a.<span class="_ _11"> </span>BLPE: If a transition through BLPE mode is desired, first set C2[LP] to 1.</div><div class="t m0 x8b hf y236b ff3 fs5 fc0 sc0 ls0 ws0">b.<span class="_ _11"> </span>BLPE/PBE: C6 = 0x40</div><div class="t m0 x29 hf y236c ff3 fs5 fc0 sc0 ls0 ws0">•<span class="_ _11"> </span>C6[PLLS] set to 1, selects the PLL. At this time, with a C1[PRDIV] value of</div><div class="t m0 x3e hf y236d ff3 fs5 fc0 sc0 ls0 ws0">2&apos;b001, the PLL reference divider is 2 (see PLL External Reference Divide</div><div class="t m0 x3e hf y236e ff3 fs5 fc0 sc0 ls0 ws0">Factor table), resulting in a reference frequency of 4 MHz/ 2 = 2 MHz. In</div><div class="t m0 x3e hf y236f ff3 fs5 fc0 sc0 ls0 ws0">BLPE mode, changing the C6[PLLS] bit only prepares the MCG for PLL</div><div class="t m0 x3e hf y2370 ff3 fs5 fc0 sc0 ls0 ws0">usage in PBE mode.</div><div class="t m0 x29 hf y2371 ff3 fs5 fc0 sc0 ls0 ws0">•<span class="_ _11"> </span>C6[VDIV0] set to 5&apos;b0000, or multiply-by-24 because 2 MHz reference * 24</div><div class="t m0 x3e hf y2372 ff3 fs5 fc0 sc0 ls0 ws0">= 48 MHz. In BLPE mode, the configuration of the VDIV bits does not</div><div class="t m0 x3e hf y2373 ff3 fs5 fc0 sc0 ls0 ws0">matter because the PLL is disabled. Changing them only sets up the multiply</div><div class="t m0 x3e hf y2374 ff3 fs5 fc0 sc0 ls0 ws0">value for PLL usage in PBE mode.</div><div class="t m0 x8b hf y2375 ff3 fs5 fc0 sc0 ls0 ws0">c.<span class="_ _11"> </span>BLPE: If transitioning through BLPE mode, clear C2[LP] to 0 here to switch to</div><div class="t m0 x3d hf y2376 ff3 fs5 fc0 sc0 ls0 ws0">PBE mode.</div><div class="t m0 x8b hf y2377 ff3 fs5 fc0 sc0 ls0 ws0">d.<span class="_ _11"> </span>PBE: Loop until S[PLLST] is set, indicating that the current source for the PLLS</div><div class="t m0 x3d hf y2378 ff3 fs5 fc0 sc0 ls0 ws0">clock is the PLL.</div><div class="t m0 x8b hf y2379 ff3 fs5 fc0 sc0 ls0 ws0">e.<span class="_ _11"> </span>PBE: Then loop until S[LOCK0] is set, indicating that the PLL has acquired</div><div class="t m0 x3d hf y237a ff3 fs5 fc0 sc0 ls0">lock.</div><div class="t m0 x9 h10 ydd ff1 fs4 fc0 sc0 ls0 ws0">Initialization / Application information</div><div class="t m0 x8 h6 y9 ff1 fs3 fc0 sc0 ls0 ws0">KL25 Sub-Family Reference Manual, Rev. 3, September 2012</div><div class="t m0 x9 h7 ya ff2 fs4 fc0 sc0 ls0 ws0">396<span class="_ _113"> </span>Freescale Semiconductor, Inc.</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div></div>
