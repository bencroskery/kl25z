<div id="pf1c7" class="pf w0 h0" data-page-no="1c7"><div class="pc pc1c7 w0 h0"><img class="bi x0 y8 w2 h5" alt="" src="bg1c7.png"/><div class="t m0 x9 h1b y502 ff1 fsc fc0 sc0 ls0 ws0">27.4.11.2<span class="_ _b"> </span>Changing the Security State</div><div class="t m0 x9 hf y503 ff3 fs5 fc0 sc0 ls0 ws0">The security state out of reset can be permanently changed by programming the security</div><div class="t m0 x9 hf y504 ff3 fs5 fc0 sc0 ls0 ws0">byte of the flash configuration field. This assumes that you are starting from a mode</div><div class="t m0 x9 hf y505 ff3 fs5 fc0 sc0 ls0 ws0">where the necessary program flash erase and program commands are available and that</div><div class="t m0 x9 hf y629 ff3 fs5 fc0 sc0 ls0 ws0">the region of the program flash containing the flash configuration field is unprotected. If</div><div class="t m0 x9 hf y62a ff3 fs5 fc0 sc0 ls0 ws0">the flash security byte is successfully programmed, its new value takes affect after the</div><div class="t m0 x9 hf yabd ff3 fs5 fc0 sc0 ls0 ws0">next chip reset.</div><div class="t m0 x9 h8 y2854 ff1 fs5 fc0 sc0 ls0 ws0">27.4.11.2.1<span class="_ _b"> </span>Unsecuring the Chip Using Backdoor Key Access</div><div class="t m0 x9 hf y1b98 ff3 fs5 fc0 sc0 ls0 ws0">The chip can be unsecured by using the backdoor key access feature, which requires</div><div class="t m0 x9 hf y14a7 ff3 fs5 fc0 sc0 ls0 ws0">knowledge of the contents of the 8-byte backdoor key value stored in the Flash</div><div class="t m0 x9 hf y14f8 ff3 fs5 fc0 sc0 ls0 ws0">Configuration Field (see <span class="fc1">Flash Configuration Field Description</span>). If the FSEC[KEYEN]</div><div class="t m0 x9 hf y1b99 ff3 fs5 fc0 sc0 ls0 ws0">bits are in the enabled state, the Verify Backdoor Access Key command (see <span class="fc1">Verify</span></div><div class="t m0 x9 hf y1869 ff3 fs5 fc1 sc0 ls0 ws0">Backdoor Access Key Command<span class="fc0">) can be run; it allows the user to present prospective</span></div><div class="t m0 x9 hf y24db ff3 fs5 fc0 sc0 ls0 ws0">keys for comparison to the stored keys. If the keys match, the FSEC[SEC] bits are</div><div class="t m0 x9 hf y24dc ff3 fs5 fc0 sc0 ls0 ws0">changed to unsecure the chip. The entire 8-byte key cannot be all 0s or all 1s; that is,</div><div class="t m0 x9 hf y2855 ff3 fs5 fc0 sc0 ls0 ws0">0000_0000_0000_0000h and FFFF_FFFF_FFFF_FFFFh are not accepted by the Verify</div><div class="t m0 x9 hf y2856 ff3 fs5 fc0 sc0 ls0 ws0">Backdoor Access Key command as valid comparison values. While the Verify Backdoor</div><div class="t m0 x9 hf y2857 ff3 fs5 fc0 sc0 ls0 ws0">Access Key command is active, program flash memory is not available for read access</div><div class="t m0 x9 hf y2858 ff3 fs5 fc0 sc0 ls0 ws0">and returns invalid data.</div><div class="t m0 x9 hf y2859 ff3 fs5 fc0 sc0 ls0 ws0">The user code stored in the program flash memory must have a method of receiving the</div><div class="t m0 x9 hf y285a ff3 fs5 fc0 sc0 ls0 ws0">backdoor keys from an external stimulus. This external stimulus would typically be</div><div class="t m0 x9 hf y285b ff3 fs5 fc0 sc0 ls0 ws0">through one of the on-chip serial ports.</div><div class="t m0 x9 hf y285c ff3 fs5 fc0 sc0 ls0 ws0">If the KEYEN bits are in the enabled state, the chip can be unsecured by the following</div><div class="t m0 x9 hf y285d ff3 fs5 fc0 sc0 ls0 ws0">backdoor key access sequence:</div><div class="t m0 xf6 hf y285e ff3 fs5 fc0 sc0 ls0 ws0">1.<span class="_ _11"> </span>Follow the command sequence for the Verify Backdoor Access Key command as</div><div class="t m0 x34 hf y285f ff3 fs5 fc0 sc0 ls0 ws0">explained in <span class="fc1">Verify Backdoor Access Key Command</span></div><div class="t m0 xf6 hf y2860 ff3 fs5 fc0 sc0 ls0 ws0">2.<span class="_ _11"> </span>If the Verify Backdoor Access Key command is successful, the chip is unsecured and</div><div class="t m0 x34 hf y2861 ff3 fs5 fc0 sc0 ls0 ws0">the FSEC[SEC] bits are forced to the unsecure state</div><div class="t m0 x9 hf y2862 ff3 fs5 fc0 sc0 ls0 ws0">An illegal key provided to the Verify Backdoor Access Key command prohibits further</div><div class="t m0 x9 hf y2863 ff3 fs5 fc0 sc0 ls0 ws0">use of the Verify Backdoor Access Key command. A reset of the chip is the only method</div><div class="t m0 x9 hf y2864 ff3 fs5 fc0 sc0 ls0 ws0">to re-enable the Verify Backdoor Access Key command when a comparison fails.</div><div class="t m0 x9 hf y2865 ff3 fs5 fc0 sc0 ls0 ws0">After the backdoor keys have been correctly matched, the chip is unsecured by changing</div><div class="t m0 x9 hf y2866 ff3 fs5 fc0 sc0 ls0 ws0">the FSEC[SEC] bits. A successful execution of the Verify Backdoor Access Key</div><div class="t m0 x9 hf y2867 ff3 fs5 fc0 sc0 ls0 ws0">command changes the security in the FSEC register only. It does not alter the security</div><div class="t m0 x9 hf y2868 ff3 fs5 fc0 sc0 ls0 ws0">byte or the keys stored in the Flash Configuration Field (<span class="fc1">Flash Configuration Field</span></div><div class="t m0 x9 hf y2869 ff3 fs5 fc1 sc0 ls0 ws1a6">Description<span class="fc0 ws0">). After the next reset of the chip, the security state of the flash memory</span></div><div class="t m0 x150 h10 y141 ff1 fs4 fc0 sc0 ls0 ws0">Chapter 27 Flash Memory Module (FTFA)</div><div class="t m0 x8 h6 y9 ff1 fs3 fc0 sc0 ls0 ws0">KL25 Sub-Family Reference Manual, Rev. 3, September 2012</div><div class="t m0 x9 h7 ya ff2 fs4 fc0 sc0 ls0 ws0">Freescale Semiconductor, Inc.<span class="_ _113"> </span>455</div><a class="l" href="#pf1a6" data-dest-detail='[422,"XYZ",null,124.364,null]'><div class="d m1" style="border-style:none;position:absolute;left:194.378000px;bottom:509.400000px;width:213.500000px;height:14.000000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf1c4" data-dest-detail='[452,"XYZ",null,115.1,null]'><div class="d m1" style="border-style:none;position:absolute;left:486.334000px;bottom:493.400000px;width:36.540000px;height:14.000000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf1c4" data-dest-detail='[452,"XYZ",null,115.1,null]'><div class="d m1" style="border-style:none;position:absolute;left:54.000000px;bottom:477.400000px;width:186.242000px;height:14.000000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf1c4" data-dest-detail='[452,"XYZ",null,115.1,null]'><div class="d m1" style="border-style:none;position:absolute;left:150.324000px;bottom:252.600000px;width:226.282000px;height:14.000000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf1a6" data-dest-detail='[422,"XYZ",null,124.364,null]'><div class="d m1" style="border-style:none;position:absolute;left:372.094000px;bottom:73.400000px;width:144.676000px;height:14.000000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf1a6" data-dest-detail='[422,"XYZ",null,124.364,null]'><div class="d m1" style="border-style:none;position:absolute;left:54.000000px;bottom:57.400000px;width:65.324000px;height:14.000000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div></div>
