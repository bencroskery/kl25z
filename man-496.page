<div id="pf1f0" class="pf w0 h0" data-page-no="1f0"><div class="pc pc1f0 w0 h0"><img class="bi x0 y8 w2 h5" alt="" src="bg1f0.png"/><div class="t m0 x9 he y17c ff1 fs1 fc0 sc0 ls0 ws0">28.4.7<span class="_ _b"> </span>User-defined offset function</div><div class="t m0 x9 hf y17d ff3 fs5 fc0 sc0 ls0 ws0">OFS contains the user-selected or calibration-generated offset error correction value. This</div><div class="t m0 x9 hf y80d ff3 fs5 fc0 sc0 ls0 ws0">register is a 2â€™s complement, left-justified. The value in OFS is subtracted from the</div><div class="t m0 x9 hf y80e ff3 fs5 fc0 sc0 ls0 ws0">conversion and the result is transferred into the result registers, Rn. If the result is greater</div><div class="t m0 x9 hf y80f ff3 fs5 fc0 sc0 ls0 ws0">than the maximum or less than the minimum result value, it is forced to the appropriate</div><div class="t m0 x9 hf y1919 ff3 fs5 fc0 sc0 ls0 ws0">limit for the current mode of operation.</div><div class="t m0 x9 hf y2693 ff3 fs5 fc0 sc0 ls0 ws0">The formatting of the OFS is different from the data result register, Rn, to preserve the</div><div class="t m0 x9 hf y2694 ff3 fs5 fc0 sc0 ls0 ws0">resolution of the calibration value regardless of the conversion mode selected. Lower</div><div class="t m0 x9 hf y2bc6 ff3 fs5 fc0 sc0 ls0 ws0">order bits are ignored in lower resolution modes. For example, in 8-bit single-ended</div><div class="t m0 x9 hf y2bc7 ff3 fs5 fc0 sc0 ls0 ws0">mode, OFS[14:7] are subtracted from D[7:0]; OFS[15] indicates the sign (negative</div><div class="t m0 x9 hf y2bc8 ff3 fs5 fc0 sc0 ls0 ws0">numbers are effectively added to the result) and OFS[6:0] are ignored. The same bits are</div><div class="t m0 x9 hf y2bc9 ff3 fs5 fc0 sc0 ls0 ws0">used in 9-bit differential mode because OFS[15] indicates the sign bit, which maps to</div><div class="t m0 x9 hf y2bca ff3 fs5 fc0 sc0 ls0 ws0">D[8]. For 16-bit differential mode, OFS[15:0] are directly subtracted from the conversion</div><div class="t m0 x9 hf y2bcb ff3 fs5 fc0 sc0 ls0 ws0">result data D[15:0]. In 16-bit single-ended mode, there is no field in the OFS</div><div class="t m0 x9 hf y2bcc ff3 fs5 fc0 sc0 ls0 ws0">corresponding to the least significant result D[0], so odd values, such as -1 or +1, cannot</div><div class="t m0 x9 hf y2bcd ff3 fs5 fc0 sc0 ls0 ws0">be subtracted from the result.</div><div class="t m0 x9 hf y2bce ff3 fs5 fc0 sc0 ls0 ws0">OFS is automatically set according to calibration requirements once the self-calibration</div><div class="t m0 x9 hf y2bcf ff3 fs5 fc0 sc0 ls0 ws0">sequence is done, that is, SC3[CAL] is cleared. The user may write to OFS to override</div><div class="t m0 x9 hf y2bd0 ff3 fs5 fc0 sc0 ls0 ws0">the calibration result if desired. If the OFS is written by the user to a value that is</div><div class="t m0 x9 hf y2bd1 ff3 fs5 fc0 sc0 ls0 ws0">different from the calibration value, the ADC error specifications may not be met. Storing</div><div class="t m0 x9 hf y2bd2 ff3 fs5 fc0 sc0 ls0 ws0">the value generated by the calibration function in memory before overwriting with a user-</div><div class="t m0 x9 hf y18de ff3 fs5 fc0 sc0 ls0 ws0">specified value is recommended.</div><div class="t m0 xda h8 y2bd3 ff1 fs5 fc0 sc0 ls0">Note</div><div class="t m0 x3e hf y2bd4 ff3 fs5 fc0 sc0 ls0 ws0">There is an effective limit to the values of offset that can be set</div><div class="t m0 x3e hf y2bd5 ff3 fs5 fc0 sc0 ls0 ws0">by the user. If the magnitude of the offset is too high, the results</div><div class="t m0 x3e hf y2bd6 ff3 fs5 fc0 sc0 ls0 ws0">of the conversions will cap off at the limits.</div><div class="t m0 x9 hf y2bd7 ff3 fs5 fc0 sc0 ls0 ws0">The offset calibration function may be employed by the user to remove application</div><div class="t m0 x9 hf y2bd8 ff3 fs5 fc0 sc0 ls0 ws0">offsets or DC bias values. OFS may be written with a number in 2&apos;s complement format</div><div class="t m0 x9 hf y2bd9 ff3 fs5 fc0 sc0 ls0 ws0">and this offset will be subtracted from the result, or hardware averaged value. To add an</div><div class="t m0 x9 hf y2bda ff3 fs5 fc0 sc0 ls0 ws0">offset, store the negative offset in 2&apos;s complement format and the effect will be an</div><div class="t m0 x9 hf y2bdb ff3 fs5 fc0 sc0 ls0 ws0">addition. An offset correction that results in an out-of-range value will be forced to the</div><div class="t m0 x9 hf y2bdc ff3 fs5 fc0 sc0 ls0 ws0">minimum or maximum value. The minimum value for single-ended conversions is</div><div class="t m0 x9 hf y2bdd ff3 fs5 fc0 sc0 ls0 ws0">0x0000; for a differential conversion it is 0x8000.</div><div class="t m0 x9 hf y2bde ff3 fs5 fc0 sc0 ls0 ws0">To preserve accuracy, the calibrated offset value initially stored in OFS must be added to</div><div class="t m0 x9 hf y2bdf ff3 fs5 fc0 sc0 ls0 ws0">the user-defined offset. For applications that may change the offset repeatedly during</div><div class="t m0 x9 hf y2be0 ff3 fs5 fc0 sc0 ls0 ws0">operation, store the initial offset calibration value in flash so it can be recovered and</div><div class="t m0 x9 hf y2be1 ff3 fs5 fc0 sc0 ls0 ws0">added to any user offset adjustment value and the sum stored in OFS.</div><div class="t m0 x9 h10 ydd ff1 fs4 fc0 sc0 ls0 ws0">Functional description</div><div class="t m0 x8 h6 y9 ff1 fs3 fc0 sc0 ls0 ws0">KL25 Sub-Family Reference Manual, Rev. 3, September 2012</div><div class="t m0 x9 h7 ya ff2 fs4 fc0 sc0 ls0 ws0">496<span class="_ _113"> </span>Freescale Semiconductor, Inc.</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div></div>
