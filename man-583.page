<div id="pf247" class="pf w0 h0" data-page-no="247"><div class="pc pc247 w0 h0"><img class="bi x0 y8 w2 h5" alt="" src="bg247.png"/><div class="t m0 x33 hf yf6 ff3 fs5 fc0 sc0 ls0 ws0">•<span class="_ _11"> </span>Timer 1 creates an interrupt every 5.12 ms.</div><div class="t m0 x33 hf y503 ff3 fs5 fc0 sc0 ls0 ws0">•<span class="_ _11"> </span>Timer 3 creates a trigger event every 30 ms.</div><div class="t m0 x9 hf y33f7 ff3 fs5 fc0 sc0 ls0 ws0">The PIT module must be activated by writing a 0 to MCR[MDIS].</div><div class="t m0 x9 hf y2065 ff3 fs5 fc0 sc0 ls0 ws0">The 50 MHz clock frequency equates to a clock period of 20 ns. Timer 1 needs to trigger</div><div class="t m0 x9 hf y2066 ff3 fs5 fc0 sc0 ls0 ws0">every 5.12 ms/20 ns = 256,000 cycles and Timer 3 every 30 ms/20 ns = 1,500,000 cycles.</div><div class="t m0 x9 hf y33f8 ff3 fs5 fc0 sc0 ls0 ws0">The value for the LDVAL register trigger is calculated as:</div><div class="t m0 x9 hf y33f9 ff3 fs5 fc0 sc0 ls0 ws0">LDVAL trigger = (period / clock period) -1</div><div class="t m0 x9 hf y2aea ff3 fs5 fc0 sc0 ls0 ws0">This means LDVAL1 and LDVAL3 must be written with 0x0003E7FF and 0x0016E35F</div><div class="t m0 x9 hf y2aeb ff3 fs5 fc0 sc0 ls0">respectively.</div><div class="t m0 x9 hf y33fa ff3 fs5 fc0 sc0 ls0 ws0">The interrupt for Timer 1 is enabled by setting TCTRL1[TIE]. The timer is started by</div><div class="t m0 x9 hf y33fb ff3 fs5 fc0 sc0 ls0 ws0">writing 1 to TCTRL1[TEN].</div><div class="t m0 x9 hf y33fc ff3 fs5 fc0 sc0 ls0 ws0">Timer 3 shall be used only for triggering. Therefore, Timer 3 is started by writing a 1 to</div><div class="t m0 x9 hf y33fd ff3 fs5 fc0 sc0 ls0 ws0">TCTRL3[TEN]. TCTRL3[TIE] stays at 0.</div><div class="t m0 x9 hf y33fe ff3 fs5 fc0 sc0 ls0 ws0">The following example code matches the described setup:</div><div class="t m0 x9 ha5 y33ff ff6 fs4 fc0 sc0 ls0 ws0">     // turn on PIT</div><div class="t m0 x9 ha5 y3400 ff6 fs4 fc0 sc0 ls0 ws0">     PIT_MCR = 0x00;</div><div class="t m0 x9 ha5 y3401 ff6 fs4 fc0 sc0 ls0 ws0">     // Timer 1</div><div class="t m0 x9 ha5 y3402 ff6 fs4 fc0 sc0 ls0 ws0">     PIT_LDVAL1 = 0x0003E7FF; // setup timer 1 for 256000 cycles</div><div class="t m0 x9 ha5 y3403 ff6 fs4 fc0 sc0 ls0 ws0">     PIT_TCTRL1 = TIE; // enable Timer 1 interrupts </div><div class="t m0 x9 ha5 y3404 ff6 fs4 fc0 sc0 ls0 ws0">     PIT_TCTRL1 |= TEN; // start Timer 1</div><div class="t m0 x9 ha5 y3405 ff6 fs4 fc0 sc0 ls0 ws0">     // Timer 3</div><div class="t m0 x9 ha5 y3406 ff6 fs4 fc0 sc0 ls0 ws0">     PIT_LDVAL3 = 0x0016E35F; // setup timer 3for 1500000 cycles</div><div class="t m0 x9 ha5 y3407 ff6 fs4 fc0 sc0 ls0 ws0">     PIT_TCTRL3 |= TEN; // start Timer 3</div><div class="t m0 x9 hd y3408 ff1 fs7 fc0 sc0 ls0 ws0">32.6<span class="_ _b"> </span>Example configuration for chained timers</div><div class="t m0 x9 hf y3409 ff3 fs5 fc0 sc0 ls0 ws0">In the example configuration:</div><div class="t m0 x33 hf y340a ff3 fs5 fc0 sc0 ls0 ws0">•<span class="_ _11"> </span>The PIT clock has a frequency of 100 MHz.</div><div class="t m0 x33 hf y340b ff3 fs5 fc0 sc0 ls0 ws0">•<span class="_ _11"> </span>Timers 1 and 2 are available.</div><div class="t m0 x33 hf y340c ff3 fs5 fc0 sc0 ls0 ws0">•<span class="_ _11"> </span>An interrupt shall be raised every 1 hour.</div><div class="t m0 x9 hf y340d ff3 fs5 fc0 sc0 ls0 ws0">The PIT module needs to be activated by writing a 0 to MCR[MDIS].</div><div class="t m0 x150 h10 y141 ff1 fs4 fc0 sc0 ls0 ws0">Chapter 32 Periodic Interrupt Timer (PIT)</div><div class="t m0 x8 h6 y9 ff1 fs3 fc0 sc0 ls0 ws0">KL25 Sub-Family Reference Manual, Rev. 3, September 2012</div><div class="t m0 x9 h7 ya ff2 fs4 fc0 sc0 ls0 ws0">Freescale Semiconductor, Inc.<span class="_ _113"> </span>583</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div></div>
