<div id="pf248" class="pf w0 h0" data-page-no="248"><div class="pc pc248 w0 h0"><img class="bi x0 y8 w2 h5" alt="" src="bg248.png"/><div class="t m0 x9 hf yf6 ff3 fs5 fc0 sc0 ls0 ws0">The 100 MHz clock frequency equates to a clock period of 10 ns, so the PIT needs to</div><div class="t m0 x9 hf yf7 ff3 fs5 fc0 sc0 ls0 ws0">count for 6000 million cycles, which is more than a single timer can do. So, Timer 1 is</div><div class="t m0 x9 hf yf8 ff3 fs5 fc0 sc0 ls0 ws0">set up to trigger every 6 s (600 million cycles). Timer 2 is chained to Timer 1 and</div><div class="t m0 x9 hf yf9 ff3 fs5 fc0 sc0 ls0 ws0">programmed to trigger 10 times.</div><div class="t m0 x9 hf y629 ff3 fs5 fc0 sc0 ls0 ws0">The value for the LDVAL register trigger is calculated as number of cycles-1, so</div><div class="t m0 x9 hf y62a ff3 fs5 fc0 sc0 ls0 ws0">LDVAL1 receives the value 0x23C345FF and LDVAL2 receives the value 0x00000009.</div><div class="t m0 x9 hf y674 ff3 fs5 fc0 sc0 ls0 ws0">The interrupt for Timer 2 is enabled by setting TCTRL2[TIE], the Chain mode is</div><div class="t m0 x9 hf y675 ff3 fs5 fc0 sc0 ls0 ws0">activated by setting TCTRL2[CHN], and the timer is started by writing a 1 to</div><div class="t m0 x9 hf y676 ff3 fs5 fc0 sc0 ls0 ws0">TCTRL2[TEN]. TCTRL1[TEN] needs to be set, and TCTRL1[CHN] and TCTRL1[TIE]</div><div class="t m0 x9 hf y677 ff3 fs5 fc0 sc0 ls0 ws0">are cleared.</div><div class="t m0 x9 hf y14e3 ff3 fs5 fc0 sc0 ls0 ws0">The following example code matches the described setup:</div><div class="t m0 x9 ha5 y340e ff6 fs4 fc0 sc0 ls0 ws0">     // turn on PIT</div><div class="t m0 x9 ha5 y340f ff6 fs4 fc0 sc0 ls0 ws0">     PIT_MCR = 0x00;</div><div class="t m0 x9 ha5 y3410 ff6 fs4 fc0 sc0 ls0 ws0">     // Timer 2</div><div class="t m0 x9 ha5 y3411 ff6 fs4 fc0 sc0 ls0 ws0">     PIT_LDVAL2 = 0x00000009; // setup Timer 2 for 10 counts</div><div class="t m0 x9 ha5 y3412 ff6 fs4 fc0 sc0 ls0 ws0">     PIT_TCTRL2 = TIE; // enable Timer 2 interrupt  </div><div class="t m0 x9 ha5 y3413 ff6 fs4 fc0 sc0 ls0 ws0">     PIT_TCTRL2 |= CHN; // chain Timer 2 to Timer 1</div><div class="t m0 x9 ha5 y3414 ff6 fs4 fc0 sc0 ls0 ws0">     PIT_TCTRL2 |= TEN; // start Timer 2</div><div class="t m0 x9 ha5 y3415 ff6 fs4 fc0 sc0 ls0 ws0">     // Timer 1</div><div class="t m0 x9 ha5 y3416 ff6 fs4 fc0 sc0 ls0 ws0">     PIT_LDVAL1 = 0x23C345FF; // setup Timer 1 for 600 000 000 cycles</div><div class="t m0 x9 ha5 y3417 ff6 fs4 fc0 sc0 ls0 ws0">     PIT_TCTRL1 = TEN; // start Timer 1</div><div class="t m0 x9 hd y3418 ff1 fs7 fc0 sc0 ls0 ws0">32.7<span class="_ _b"> </span>Example configuration for the lifetime timer</div><div class="t m0 x9 hf y3419 ff3 fs5 fc0 sc0 ls0 ws0">To configure the lifetimer timer, channels 0 and 1 need to be chained together.</div><div class="t m0 x9 hf y341a ff3 fs5 fc0 sc0 ls0 ws0">First the PIT module needs to be activated by writing a 0 to the MDIS bit in the CTRL</div><div class="t m0 x9 hf y341b ff3 fs5 fc0 sc0 ls0 ws0">register, then the LDVAL registers need to be set to the maximum value.</div><div class="t m0 x9 hf y341c ff3 fs5 fc0 sc0 ls0 ws0">The timer is a downcounter.</div><div class="t m0 x9 hf y341d ff3 fs5 fc0 sc0 ls0 ws0">The following example code matches the described setup:</div><div class="t m0 x9 ha5 y341e ff6 fs4 fc0 sc0 ls0 ws0">     // turn on PIT</div><div class="t m0 x9 ha5 y341f ff6 fs4 fc0 sc0 ls0 ws0">     PIT_MCR = 0x00;</div><div class="t m0 x9 ha5 y3420 ff6 fs4 fc0 sc0 ls0 ws0">     // Timer 1</div><div class="t m0 x9 ha5 y3421 ff6 fs4 fc0 sc0 ls0 ws0">     PIT_LDVAL1 = 0xFFFFFFFF; // setup timer 1 for maximum counting period</div><div class="t m0 x9 ha5 y3422 ff6 fs4 fc0 sc0 ls0 ws0">     PIT_TCTRL1 = 0x0; // disable timer 1 interrupts</div><div class="t m0 x9 ha5 y3423 ff6 fs4 fc0 sc0 ls0 ws0">     PIT_TCTRL1 |= CHN; // chain timer 1 to timer 0</div><div class="t m0 x9 ha5 y3424 ff6 fs4 fc0 sc0 ls0 ws0">     PIT_TCTRL1 |= TEN; // start timer 1</div><div class="t m0 x9 ha5 y3425 ff6 fs4 fc0 sc0 ls0 ws0">     // Timer 0</div><div class="t m0 x9 h10 ydd ff1 fs4 fc0 sc0 ls0 ws0">Example configuration for the lifetime timer</div><div class="t m0 x8 h6 y9 ff1 fs3 fc0 sc0 ls0 ws0">KL25 Sub-Family Reference Manual, Rev. 3, September 2012</div><div class="t m0 x9 h7 ya ff2 fs4 fc0 sc0 ls0 ws0">584<span class="_ _113"> </span>Freescale Semiconductor, Inc.</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div></div>
