<div id="pf2ac" class="pf w0 h0" data-page-no="2ac"><div class="pc pc2ac w0 h0"><img class="bi x0 y8 w2 h5" alt="" src="bg2ac.png"/><div class="t m0 xf6 hf yf6 ff3 fs5 fc0 sc0 ls0 ws0">5.<span class="_ _11"> </span>In the master, read SPIx_S while SPTEF = 1, and then write to the transmit data</div><div class="t m0 x117 hf yf7 ff3 fs5 fc0 sc0 ls0 ws0">register (SPIx_D) to begin transfer.</div><div class="t m0 x9 he y3c48 ff1 fs1 fc0 sc0 ls0 ws0">37.5.2<span class="_ _b"> </span>Pseudo-Code Example</div><div class="t m0 x9 hf y3c49 ff3 fs5 fc0 sc0 ls0 ws0">In this example, the SPI module is set up for master mode with only hardware match</div><div class="t m0 x9 hf y1d7a ff3 fs5 fc0 sc0 ls0 ws0">interrupts enabled. The SPI runs at a maximum baud rate of bus clock divided by 2.</div><div class="t m0 x9 hf y1d7b ff3 fs5 fc0 sc0 ls0 ws0">Clock phase and polarity are set for an active-high SPI clock where the first edge on</div><div class="t m0 x9 hf y1d7c ff3 fs5 fc0 sc0 ls0 ws0">SPSCK occurs at the start of the first cycle of a data transfer.</div><div class="t m0 x89 h10 y3311 ff1 fs4 fc0 sc0 ls0">SPIx_C1=0x54(%01010100)</div><div class="t m0 xfb h7 y3c4a ff2 fs4 fc0 sc0 ls0 ws0">Bit 7<span class="_ _150"> </span>SPIE<span class="_ _122"> </span>=<span class="_ _120"> </span>0<span class="_ _120"> </span>Disables receive and mode fault interrupts</div><div class="t m0 xfb h7 y3af1 ff2 fs4 fc0 sc0 ls0 ws0">Bit 6<span class="_ _150"> </span>SPE<span class="_ _de"> </span>=<span class="_ _14e"> </span>1<span class="_ _120"> </span>Enables the SPI system</div><div class="t m0 xfb h7 y3c4b ff2 fs4 fc0 sc0 ls0 ws0">Bit 5<span class="_ _150"> </span>SPTIE<span class="_ _119"> </span>=<span class="_ _120"> </span>0<span class="_ _120"> </span>Disables SPI transmit interrupts</div><div class="t m0 xfb h7 y3c4c ff2 fs4 fc0 sc0 ls0 ws0">Bit 4<span class="_ _150"> </span>MSTR<span class="_ _177"> </span>=<span class="_ _14e"> </span>1<span class="_ _38"> </span>Sets the SPI module as a master SPI device</div><div class="t m0 xfb h7 y1a39 ff2 fs4 fc0 sc0 ls0 ws0">Bit 3<span class="_ _150"> </span>CPOL<span class="_ _12d"> </span>=<span class="_ _120"> </span>0<span class="_ _120"> </span>Configures SPI clock as active-high</div><div class="t m0 xfb h7 y3c4d ff2 fs4 fc0 sc0 ls0 ws0">Bit 2<span class="_ _150"> </span>CPHA<span class="_ _9e"> </span>=<span class="_ _120"> </span>1<span class="_ _120"> </span>First edge on SPSCK at start of first data transfer cycle</div><div class="t m0 xfb h7 y3c4e ff2 fs4 fc0 sc0 ls0 ws0">Bit 1<span class="_ _150"> </span>SSOE<span class="_ _9e"> </span>=<span class="_ _120"> </span>0<span class="_ _120"> </span>Determines SS pin function when mode fault enabled</div><div class="t m0 xfb h7 y3c4f ff2 fs4 fc0 sc0 ls0 ws0">Bit 0<span class="_ _150"> </span>LSBFE<span class="_ _a5"> </span>=<span class="_ _120"> </span>0<span class="_ _120"> </span>SPI serial data transfers start with most significant bit</div><div class="t m0 x89 h10 y1ca7 ff1 fs4 fc0 sc0 ls0 ws0">SPIx_C2 = 0x80(%10000000)</div><div class="t m0 xfb h7 y3c50 ff2 fs4 fc0 sc0 ls0 ws0">Bit 7<span class="_ _150"> </span>SPMIE<span class="_ _40"> </span>=<span class="_ _14e"> </span>1<span class="_ _120"> </span>SPI hardware match interrupt enabled</div><div class="t m0 xfb h7 y3c51 ff2 fs4 fc0 sc0 ls0 ws0">Bit 6<span class="_ _bc"> </span>=<span class="_ _14e"> </span>0<span class="_ _120"> </span>Unimplemented</div><div class="t m0 xfb h7 y3c52 ff2 fs4 fc0 sc0 ls0 ws0">Bit 5<span class="_ _150"> </span>TXDMAE<span class="_ _5e"> </span>=<span class="_ _120"> </span>0<span class="_ _120"> </span>DMA request disabled</div><div class="t m0 xfb h7 y3c53 ff2 fs4 fc0 sc0 ls0 ws0">Bit 4<span class="_ _150"> </span>MODFEN<span class="_ _47"> </span>=<span class="_ _120"> </span>0<span class="_ _120"> </span>Disables mode fault function</div><div class="t m0 xfb h7 y2fe2 ff2 fs4 fc0 sc0 ls0 ws0">Bit 3<span class="_ _150"> </span>BIDIROE<span class="_ _b6"> </span>=<span class="_ _120"> </span>0<span class="_ _120"> </span>SPI data I/O pin acts as input</div><div class="t m0 xfb h7 y3c54 ff2 fs4 fc0 sc0 ls0 ws0">Bit 2<span class="_ _150"> </span>RXDMAE<span class="_ _21"> </span>=<span class="_ _120"> </span>0<span class="_ _120"> </span>DMA request disabled</div><div class="t m0 xfb h7 y3c55 ff2 fs4 fc0 sc0 ls0 ws0">Bit 1<span class="_ _150"> </span>SPISWAI<span class="_ _5e"> </span>=<span class="_ _120"> </span>0<span class="_ _120"> </span>SPI clocks operate in wait mode</div><div class="t m0 xfb h7 y3c56 ff2 fs4 fc0 sc0 ls0 ws0">Bit 0<span class="_ _150"> </span>SPC0<span class="_ _14f"> </span>=<span class="_ _14e"> </span>0<span class="_ _120"> </span>uses separate pins for data input and output</div><div class="t m0 x89 h10 y3c57 ff1 fs4 fc0 sc0 ls0 ws0">SPIx_BR = 0x00(%00000000)</div><div class="t m0 xfb h7 y2a8e ff2 fs4 fc0 sc0 ls0 ws0">Bit 7<span class="_ _bc"> </span>=<span class="_ _14e"> </span>0<span class="_ _120"> </span>Reserved</div><div class="t m0 xfb h7 y3c58 ff2 fs4 fc0 sc0 ls0 ws0">Bit 6:4<span class="_ _1b1"> </span>=<span class="_ _120"> </span>000<span class="_ _196"> </span>Sets prescale divisor to 1</div><div class="t m0 xfb h7 y3c59 ff2 fs4 fc0 sc0 ls0 ws0">Bit 3:0<span class="_ _1b1"> </span>=<span class="_ _120"> </span>0000<span class="_ _112"> </span>Sets baud rate divisor to 2</div><div class="t m0 x89 h10 y3c5a ff1 fs4 fc0 sc0 ls0 ws0">SPIx_S = 0x00(%00000000)</div><div class="t m0 xfb h7 y3c5b ff2 fs4 fc0 sc0 ls0 ws0">Bit 7<span class="_ _150"> </span>SPRF<span class="_ _93"> </span>=<span class="_ _120"> </span>0<span class="_ _120"> </span>Flag is set when receive data buffer is full</div><div class="t m0 xfb h7 y3c5c ff2 fs4 fc0 sc0 ls0 ws0">Bit 6<span class="_ _150"> </span>SPMF<span class="_ _9e"> </span>=<span class="_ _120"> </span>0<span class="_ _120"> </span>Flag is set when SPIx_M = receive data buffer</div><div class="t m0 x1b h7 y3c5d ff5 fs4 fc0 sc0 ls0 ws0">Table continues on the next page...</div><div class="t m0 x9 h10 ydd ff1 fs4 fc0 sc0 ls0 ws0">Initialization/Application Information</div><div class="t m0 x8 h6 y9 ff1 fs3 fc0 sc0 ls0 ws0">KL25 Sub-Family Reference Manual, Rev. 3, September 2012</div><div class="t m0 x9 h7 ya ff2 fs4 fc0 sc0 ls0 ws0">684<span class="_ _113"> </span>Freescale Semiconductor, Inc.</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div></div>
