<div id="pf2cc" class="pf w0 h0" data-page-no="2cc"><div class="pc pc2cc w0 h0"><img class="bi x0 y8 w2 h5" alt="" src="bg2cc.png"/><div class="t m0 x9 he y17c ff1 fs1 fc0 sc0 ls0 ws0">38.4.9<span class="_ _b"> </span>DMA support</div><div class="t m0 x9 hf y17d ff3 fs5 fc0 sc0 ls0 ws0">If the DMAEN bit is cleared and the IICIE bit is set, an interrupt condition generates an</div><div class="t m0 x9 hf y80d ff3 fs5 fc0 sc0 ls0 ws0">interrupt request. If the DMAEN bit is set and the IICIE bit is set, an interrupt condition</div><div class="t m0 x9 hf y80e ff3 fs5 fc0 sc0 ls0 ws0">generates a DMA request instead. DMA requests are generated by the transfer complete</div><div class="t m0 x9 hf y80f ff3 fs5 fc0 sc0 ls0 ws0">flag (TCF).</div><div class="t m0 x9 hf y1d1e ff3 fs5 fc0 sc0 ls0 ws0">If the DMAEN bit is set, the only arbitration lost is to another I2C module (error), and</div><div class="t m0 x9 hf y2693 ff3 fs5 fc0 sc0 ls0 ws0">SCL low timeouts (error) generate CPU interrupts. All other events initiate a DMA</div><div class="t m0 x9 hf y2694 ff3 fs5 fc0 sc0 ls0">transfer.</div><div class="t m0 x10e h8 y3ee4 ff1 fs5 fc0 sc0 ls0">NOTE</div><div class="t m0 x3e hf y3ee5 ff3 fs5 fc0 sc0 ls0 ws0">Before the last byte of master receive mode, TXAK must be set</div><div class="t m0 x3e hf y3ee6 ff3 fs5 fc0 sc0 ls0 ws0">to send a NACK after the last byte’s transfer. Therefore, the</div><div class="t m0 x3e hf y3ee7 ff3 fs5 fc0 sc0 ls0 ws0">DMA must be disabled before the last byte’s transfer.</div><div class="t m0 x10e h8 y3ee8 ff1 fs5 fc0 sc0 ls0">NOTE</div><div class="t m0 x3e hf y3ee9 ff3 fs5 fc0 sc0 ls0 ws0">In 10-bit address mode transmission, the addresses to send</div><div class="t m0 x3e hf y3eea ff3 fs5 fc0 sc0 ls0 ws0">occupy 2-3 bytes. During this transfer period, the DMA must be</div><div class="t m0 x3e hf y3eeb ff3 fs5 fc0 sc0 ls0 ws0">disabled because the C1 register is written to send a repeat start</div><div class="t m0 x3e hf y3eec ff3 fs5 fc0 sc0 ls0 ws0">or to change the transfer direction.</div><div class="t m0 x9 hd y3eed ff1 fs7 fc0 sc0 ls0 ws0">38.5<span class="_ _b"> </span>Initialization/application information</div><div class="t m0 x9 hf y3eee ff3 fs5 fc0 sc0 ls0 ws0">Module Initialization (Slave)</div><div class="t m0 xf6 hf y3eef ff3 fs5 fc0 sc0 ls0 ws0">1.<span class="_ _11"> </span>Write: Control Register 2</div><div class="t m0 x2 hf y3ef0 ff3 fs5 fc0 sc0 ls0 ws0">•<span class="_ _11"> </span>to enable or disable general call</div><div class="t m0 x2 hf y3ef1 ff3 fs5 fc0 sc0 ls0 ws0">•<span class="_ _11"> </span>to select 10-bit or 7-bit addressing mode</div><div class="t m0 xf6 hf y3ef2 ff3 fs5 fc0 sc0 ls0 ws0">2.<span class="_ _11"> </span>Write: Address Register 1 to set the slave address</div><div class="t m0 xf6 hf y3ef3 ff3 fs5 fc0 sc0 ls0 ws0">3.<span class="_ _11"> </span>Write: Control Register 1 to enable the I2C module and interrupts</div><div class="t m0 xf6 hf y3ef4 ff3 fs5 fc0 sc0 ls0 ws0">4.<span class="_ _11"> </span>Initialize RAM variables (IICEN = 1 and IICIE = 1) for transmit data</div><div class="t m0 xf6 hf y3ef5 ff3 fs5 fc0 sc0 ls0 ws0">5.<span class="_ _11"> </span>Initialize RAM variables used to achieve the routine shown in the following figure</div><div class="t m0 x9 hf y3ef6 ff3 fs5 fc0 sc0 ls0 ws0">Module Initialization (Master)</div><div class="t m0 xf6 hf y3ef7 ff3 fs5 fc0 sc0 ls0 ws0">1.<span class="_ _11"> </span>Write: Frequency Divider register to set the I2C baud rate (see example in</div><div class="t m0 x117 hf y3ef8 ff3 fs5 fc0 sc0 ls0 ws0">description of <span class="fc1 ws1a6">ICR</span>)</div><div class="t m0 xf6 hf y3ef9 ff3 fs5 fc0 sc0 ls0 ws0">2.<span class="_ _11"> </span>Write: Control Register 1 to enable the I2C module and interrupts</div><div class="t m0 xf6 hf y3efa ff3 fs5 fc0 sc0 ls0 ws0">3.<span class="_ _11"> </span>Initialize RAM variables (IICEN = 1 and IICIE = 1) for transmit data</div><div class="t m0 xf6 hf y3efb ff3 fs5 fc0 sc0 ls0 ws0">4.<span class="_ _11"> </span>Initialize RAM variables used to achieve the routine shown in the following figure</div><div class="t m0 xf6 hf y3efc ff3 fs5 fc0 sc0 ls0 ws0">5.<span class="_ _11"> </span>Write: Control Register 1 to enable TX</div><div class="t m0 x9 h10 ydd ff1 fs4 fc0 sc0 ls0 ws0">Initialization/application information</div><div class="t m0 x8 h6 y9 ff1 fs3 fc0 sc0 ls0 ws0">KL25 Sub-Family Reference Manual, Rev. 3, September 2012</div><div class="t m0 x9 h7 ya ff2 fs4 fc0 sc0 ls0 ws0">716<span class="_ _113"> </span>Freescale Semiconductor, Inc.</div><a class="l" href="#pf2b3" data-dest-detail='[691,"XYZ",null,349.85,null]'><div class="d m1" style="border-style:none;position:absolute;left:158.878000px;bottom:123.200000px;width:23.338000px;height:14.000000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div></div>
