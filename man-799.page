<div id="pf31f" class="pf w0 h0" data-page-no="31f"><div class="pc pc31f w0 h0"><img class="bi x0 y8 w2 h5" alt="" src="bg31f.png"/><div class="t m0 x9 he y45c6 ff1 fs1 fc0 sc0 ls0 ws0">42.4.8<span class="_ _b"> </span>Current source</div><div class="t m0 x9 hf y39d8 ff3 fs5 fc0 sc0 ls0 ws0">The TSI module supports eight different current source power to increment from 500 nA</div><div class="t m0 x9 hf y3efd ff3 fs5 fc0 sc0 ls0 ws0">to 64uA. The TSI_GENCS[EXTCHRG] bits determine the current of electrode oscillator</div><div class="t m0 x9 hf y1e32 ff3 fs5 fc0 sc0 ls0 ws0">that charges and discharges external electrodes. The TSI_GENCS[REFCHRG] bits</div><div class="t m0 x9 hf y1e33 ff3 fs5 fc0 sc0 ls0 ws0">determine the current of reference oscillator on which the internal reference clock</div><div class="t m0 x9 hf y24ff ff3 fs5 fc0 sc0 ls0 ws0">depends. The lower current source takes more time for charge and discharge, which is</div><div class="t m0 x9 hf y42c ff3 fs5 fc0 sc0 ls0 ws0">useful to detect high-accuracy change. The higher current source takes less time, which</div><div class="t m0 x9 hf y5da ff3 fs5 fc0 sc0 ls0 ws0">can be used to charge a big electrode by less power consumption.</div><div class="t m0 x9 hf y3b0a ff3 fs5 fc0 sc0 ls0 ws0">The TSI_GENCS[CURSW] bit allows the current source to swap, so that the reference</div><div class="t m0 x9 hf y3b0b ff3 fs5 fc0 sc0 ls0 ws0">oscillator and electrode oscillator use the opposite current sources. When</div><div class="t m0 x9 hf y3b0c ff3 fs5 fc0 sc0 ls0 ws0">TSI_GENCS[CURSW] is set and the current sources are swapped, the</div><div class="t m0 x9 hf y3b0d ff3 fs5 fc0 sc0 ls0 ws0">TSI_GENCS[EXTCHRG] bits and TSI_GENCS[REFCHRG] bits still control the</div><div class="t m0 x9 hf y2747 ff3 fs5 fc0 sc0 ls0 ws0">corresponding current sources, that is, TSI_GENCS[EXTCHRG] controls the reference</div><div class="t m0 x9 hf y26b6 ff3 fs5 fc0 sc0 ls0 ws0">oscillator current and TSI_GENCS[REFCHRG] controls the electrode oscillator current.</div><div class="t m0 x9 he y45c7 ff1 fs1 fc0 sc0 ls0 ws0">42.4.9<span class="_ _b"> </span>End of scan</div><div class="t m0 x9 hf y2055 ff3 fs5 fc0 sc0 ls0 ws0">As a scan starts, [SCNIP] bit is set to indicate scan is in progress. When the scan</div><div class="t m0 x9 hf y2056 ff3 fs5 fc0 sc0 ls0 ws0">completes, the [EOSF] bit is set. Before clearing the [EOSF] bit, the value in</div><div class="t m0 x9 hf y4480 ff3 fs5 fc0 sc0 ls0 ws0">TSI_DATA[TSICNT] must be read. If the TSI_GENCS[TSIIEN] bit is set</div><div class="t m0 x9 hf y4481 ff3 fs5 fc0 sc0 ls0 ws0">andTSI_GENCS[DMAEN]is not set, an interrupt is submitted to CPU for post-</div><div class="t m0 x9 hf y4482 ff3 fs5 fc0 sc0 ls0 ws0">processing immediately. The interrupt is also optional to wake MCU to execute ISR if it</div><div class="t m0 x9 hf y45c8 ff3 fs5 fc0 sc0 ls0 ws0">is in low power mode. When DMA function is enabled by setting TSI_GENCS[TSIIEN]</div><div class="t m0 x9 hf y45c9 ff3 fs5 fc0 sc0 ls0 ws0">and TSI_GENCS[ESOR], as soon as scan completes, a DMA transfer request is asserted</div><div class="t m0 x9 hf y45ca ff3 fs5 fc0 sc0 ls0 ws0">to DMA controller for data movement, generally, DMA engine will fetch TSI conversion</div><div class="t m0 x9 hf yb1 ff3 fs5 fc0 sc0 ls0 ws0">result from TSI_DATA register,store it to other memory space and then refresh the TSI</div><div class="t m0 x9 hf y45cb ff3 fs5 fc0 sc0 ls0 ws0">scan channel index(TSI_DATA[TSICH]) for next loop. When DMA transfer is done,</div><div class="t m0 x9 hf y3b01 ff3 fs5 fc0 sc0 ls0 ws0">TSI_GENCS[EOSF] is cleared automatically.</div><div class="t m0 x9 he y45cc ff1 fs1 fc0 sc0 ls0 ws0">42.4.10<span class="_ _b"> </span>Out-of-range interrupt</div><div class="t m0 x9 hf y45cd ff3 fs5 fc0 sc0 ls0 ws0">If enabled, TSI will scan the electrode specified by TSI_DATA[TSICH] as soon as the</div><div class="t m0 x9 hf y34a6 ff3 fs5 fc0 sc0 ls0 ws0">trigger arrives. The TSI_GENCS[OUTRGF] flag generates a TSI interrupt request if the</div><div class="t m0 x9 hf y1375 ff3 fs5 fc0 sc0 ls0 ws0">TSI_GENCS[TSIIE] bit is set and GENCS[ESOR] bit is cleared. With this configuration,</div><div class="t m0 x9 hf y1376 ff3 fs5 fc0 sc0 ls0 ws0">after the end-of-electrode scan, the electrode capacitance will be converted and stored to</div><div class="t m0 x9 hf y1377 ff3 fs5 fc0 sc0 ls0 ws0">the result register TSI_DATA[TSICNT], the out-of-range interrupt is only requested if</div><div class="t m0 xb3 h10 y141 ff1 fs4 fc0 sc0 ls0 ws0">Chapter 42 Touch Sensing Input (TSI)</div><div class="t m0 x8 h6 y9 ff1 fs3 fc0 sc0 ls0 ws0">KL25 Sub-Family Reference Manual, Rev. 3, September 2012</div><div class="t m0 x9 h7 ya ff2 fs4 fc0 sc0 ls0 ws0">Freescale Semiconductor, Inc.<span class="_ _113"> </span>799</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div></div>
